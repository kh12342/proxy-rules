proxies:
  - {name: ğŸŒ Direct, type: direct, udp: true}
  - {name: â›”ï¸ Reject, type: reject}
  - {name: ğŸŒ DNS_Hijack, type: dns}

proxy_groups: &proxy_groups
    type: select
    proxies:
      - ğŸ¯ Proxies
      - â™»ï¸ Urltest
      - ğŸ‡­ğŸ‡° HKG
      - ğŸ‡¹ğŸ‡¼ TWN
      - ğŸ‡¸ğŸ‡¬ SGP
      - ğŸ‡¯ğŸ‡µ JPN
      - ğŸ‡ºğŸ‡² USA
      - ğŸŒ Global
      - ğŸ¬ 0.2X
      - ğŸ  Home
      - ğŸŒ Direct
      - â›”ï¸ Reject

proxy-groups:
  - name: ğŸ¯ Proxies
    type: select
    proxies:
      - â™»ï¸ Urltest
      - ğŸ‡­ğŸ‡° HKG
      - ğŸ‡¹ğŸ‡¼ TWN
      - ğŸ‡¸ğŸ‡¬ SGP
      - ğŸ‡¯ğŸ‡µ JPN
      - ğŸ‡ºğŸ‡² USA
      - ğŸŒ Global
      - ğŸ¬ 0.2X
      - ğŸ  Home
      - ğŸŒ Direct

  - name: â™»ï¸ Urltest
    type: url-test
    <<: *A

  - name: BiliBili
    type: select
    proxies:
      - ğŸ¯ Proxies
      - ğŸ‡­ğŸ‡° HKG
      - ğŸ‡¹ğŸ‡¼ TWN
      - ğŸŒ Global
      - ğŸ¬ 0.2X
      - ğŸŒ Direct

  - name: Emby
    type: select
    proxies:
      - ğŸ¯ Proxies
      - ğŸ‡ºğŸ‡² USA
      - ğŸ¬ 0.2X
      - ğŸŒ Direct

  - name: Spotify
    <<: *proxy_groups

  - name: TikTok
    <<: *proxy_groups

  - name: Twitter
    <<: *proxy_groups

  - name: YouTube
    <<: *proxy_groups

  - name: AD
    type: select
    proxies:
      - â›”ï¸ Reject
      - ğŸŒ Direct
      - REJECT-DROP
      - PASS

  - name: Final
    <<: *proxy_groups

  - name: ğŸ‡­ğŸ‡° HKG
    filter: "^(?=.*(é¦™æ¸¯|HKG)).*$"
    <<: *All

  - name: ğŸ‡¹ğŸ‡¼ TWN
    filter: "^(?=.*(å°æ¹¾|TWN)).*$"
    <<: *All

  - name: ğŸ‡¸ğŸ‡¬ SGP
    filter: "^(?=.*(æ–°åŠ å¡|SGP)).*$"
    <<: *All

  - name: ğŸ‡¯ğŸ‡µ JPN
    filter: "^(?=.*(æ—¥æœ¬|JPN)).*$"
    <<: *All

  - name: ğŸ‡ºğŸ‡² USA
    filter: "^(?=.*(ç¾å›½|USA)).*$"
    <<: *All

  - name: ğŸŒ Global
    filter: "^(?!.*(é¦™æ¸¯|HKG|æ—¥æœ¬|JPN|ç¾å›½|USA|å°æ¹¾|TWN|æ–°åŠ å¡|SGP|åˆ°æœŸ|Expire|æµé‡|Traffic)).*$"
    <<: *All

  - name: ğŸ¬ 0.2X
    filter: "^(?=.*(å®éªŒæ€§)).*$"
    <<: *All

  - name: ğŸ  Home
    filter: "^(?=.*(19)).*$"
    <<: *All


rule-anchor:
  Apps: &Apps
    type: http
    behavior: classical
    format: text
    interval: 86400

  IPCIDR: &IPCIDR
    type: http
    behavior: ipcidr
    format: mrs
    interval: 86400

  Domain: &Domain
    type: http
    behavior: domain
    format: mrs
    interval: 86400

rule-providers:
  AI:
    <<: *Apps
    path: ./rules/AI.list
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/AI.list"

  BiliBili:
    <<: *Apps
    path: ./rules/BiliBili.list
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/BiliBili.list"

  Direct:
    <<: *Apps
    path: ./rules/Direct.list
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/Direct.list"

  Microsoft:
    <<: *Apps
    path: ./rules/Microsoft.list
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/Microsoft.list"

  Proxies:
    <<: *Apps
    path: ./rules/Proxies.list
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/Proxies.list"

  AD:
    <<: *Domain
    path: ./rules/AD.mrs
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/AD.mrs"

  Apple_Domain:
    <<: *Domain
    path: ./rules/Apple_Domain.mrs
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/Apple_Domain.mrs"

  Apple_IP:
    <<: *IPCIDR
    path: ./rules/Apple_IP.mrs
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/Apple_IP.mrs"

  Bahamut:
    <<: *Domain
    path: ./rules/Bahamut.mrs
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/bahamut.mrs"

  CN_Domain:
    <<: *Domain
    path: ./rules/CN_Domain.mrs
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/CN_Domain.mrs"

  CN_IP:
    <<: *IPCIDR
    path: ./rules/CN_IP.mrs
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/CN_IP.mrs"

  Emby:
    <<: *Domain
    path: ./rules/Emby.mrs
    url: "https://raw.githubusercontent.com/kh12342/proxy-rules/refs/heads/main/rule/Emby.mrs"

  Google_Domain:
    <<: *Domain
    path: ./rules/Google_Domain.mrs
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google.mrs"

  Google_IP:
    <<: *IPCIDR
    path: ./rules/Google_IP.mrs
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.mrs"

  Spotify:
    <<: *Domain
    path: ./rules/Spotify.mrs
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/spotify.mrs"

  Telegram_Domain:
    <<: *Domain
    path: ./rules/Telegram_Domain.mrs
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.mrs"

  Telegram_IP:
    <<: *IPCIDR
    path: ./rules/Telegram_IP.mrs
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.mrs"

  TikTok:
    <<: *Domain
    path: ./rules/TikTok.mrs
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/tiktok.mrs"

  Twitter_Domain:
    <<: *Domain
    path: ./rules/Twitter_Domain.mrs
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/twitter.mrs"

  Twitter_IP:
    <<: *IPCIDR
    path: ./rules/Twitter_IP.mrs
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/twitter.mrs"
    
  YouTube:
    <<: *Domain
    path: ./rules/YouTube.mrs
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.mrs"

rules:
  - DST-PORT,53,ğŸŒ DNS_Hijack
  - RULE-SET,Proxies,ğŸ¯ Proxies
  - RULE-SET,Emby,Emby
  - RULE-SET,AD,AD
  - RULE-SET,AI,ğŸ‡ºğŸ‡² USA
  - RULE-SET,Telegram_Domain,ğŸ‡¸ğŸ‡¬ SGP
  - RULE-SET,Telegram_IP,ğŸ‡¸ğŸ‡¬ SGP,no-resolve
  - RULE-SET,YouTube,YouTube
  - RULE-SET,Twitter_Domain,Twitter
  - RULE-SET,Twitter_IP,Twitter,no-resolve
  - RULE-SET,Bahamut,ğŸ‡¹ğŸ‡¼ TWN
  - RULE-SET,BiliBili,BiliBili
  - RULE-SET,Apple_Domain,ğŸ‡ºğŸ‡² USA
  - RULE-SET,Apple_IP,ğŸ‡ºğŸ‡² USA,no-resolve
  - RULE-SET,Microsoft,ğŸ‡ºğŸ‡² USA
  - RULE-SET,Spotify,Spotify
  - RULE-SET,Google_Domain,ğŸ¯ Proxies
  - RULE-SET,Google_IP,ğŸ¯ Proxies,no-resolve
  - RULE-SET,TikTok,TikTok
  - RULE-SET,Direct,ğŸŒ Direct
  - RULE-SET,CN_Domain,ğŸŒ Direct
  - RULE-SET,CN_IP,ğŸŒ Direct,no-resolve
  - MATCH,Final
